<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>D&D.Sci Sep 2022 Evaluator</title>
</head>
<body>
  <div id="studentA">You Allocate Student A to <span id=studentAchoice> <button onclick="allocate('A','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('A','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('A','Serpentyne')">Serpentyne</button> <button onclick="allocate('A','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentB">You Allocate Student B to <span id=studentBchoice> <button onclick="allocate('B','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('B','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('B','Serpentyne')">Serpentyne</button> <button onclick="allocate('B','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentC">You Allocate Student C to <span id=studentCchoice> <button onclick="allocate('C','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('C','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('C','Serpentyne')">Serpentyne</button> <button onclick="allocate('C','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentD">You Allocate Student D to <span id=studentDchoice> <button onclick="allocate('D','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('D','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('D','Serpentyne')">Serpentyne</button> <button onclick="allocate('D','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentE">You Allocate Student E to <span id=studentEchoice> <button onclick="allocate('E','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('E','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('E','Serpentyne')">Serpentyne</button> <button onclick="allocate('E','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentF">You Allocate Student F to <span id=studentFchoice> <button onclick="allocate('F','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('F','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('F','Serpentyne')">Serpentyne</button> <button onclick="allocate('F','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentG">You Allocate Student G to <span id=studentGchoice> <button onclick="allocate('G','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('G','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('G','Serpentyne')">Serpentyne</button> <button onclick="allocate('G','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentH">You Allocate Student H to <span id=studentHchoice> <button onclick="allocate('H','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('H','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('H','Serpentyne')">Serpentyne</button> <button onclick="allocate('H','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentI">You Allocate Student I to <span id=studentIchoice> <button onclick="allocate('I','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('I','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('I','Serpentyne')">Serpentyne</button> <button onclick="allocate('I','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentJ">You Allocate Student J to <span id=studentJchoice> <button onclick="allocate('J','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('J','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('J','Serpentyne')">Serpentyne</button> <button onclick="allocate('J','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentK">You Allocate Student K to <span id=studentKchoice> <button onclick="allocate('K','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('K','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('K','Serpentyne')">Serpentyne</button> <button onclick="allocate('K','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentL">You Allocate Student L to <span id=studentLchoice> <button onclick="allocate('L','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('L','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('L','Serpentyne')">Serpentyne</button> <button onclick="allocate('L','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentM">You Allocate Student M to <span id=studentMchoice> <button onclick="allocate('M','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('M','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('M','Serpentyne')">Serpentyne</button> <button onclick="allocate('M','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentN">You Allocate Student N to <span id=studentNchoice> <button onclick="allocate('N','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('N','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('N','Serpentyne')">Serpentyne</button> <button onclick="allocate('N','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentO">You Allocate Student O to <span id=studentOchoice> <button onclick="allocate('O','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('O','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('O','Serpentyne')">Serpentyne</button> <button onclick="allocate('O','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentP">You Allocate Student P to <span id=studentPchoice> <button onclick="allocate('P','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('P','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('P','Serpentyne')">Serpentyne</button> <button onclick="allocate('P','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentQ">You Allocate Student Q to <span id=studentQchoice> <button onclick="allocate('Q','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('Q','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('Q','Serpentyne')">Serpentyne</button> <button onclick="allocate('Q','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentR">You Allocate Student R to <span id=studentRchoice> <button onclick="allocate('R','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('R','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('R','Serpentyne')">Serpentyne</button> <button onclick="allocate('R','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentS">You Allocate Student S to <span id=studentSchoice> <button onclick="allocate('S','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('S','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('S','Serpentyne')">Serpentyne</button> <button onclick="allocate('S','Humblescrumble')">Humblescrumble</button> </span>
  <div id="studentT">You Allocate Student T to <span id=studentTchoice> <button onclick="allocate('T','Dragonslayer')">Dragonslayer</button> <button onclick="allocate('T','Thought-Talon')">Thought-Talon</button> <button onclick="allocate('T','Serpentyne')">Serpentyne</button> <button onclick="allocate('T','Humblescrumble')">Humblescrumble</button> </span>
  <br>
  <br>
  <div id="buttonLine"><button onclick="confirm()">Confirm</button></div>
  <br>
  <div id="amtLine"></div>
  <br>
  <div id="resultLine"></div>
  <br>
<b style="font-size:28px">
</div>
  
</b>
<script id="jsbin-javascript">


decisions = {"A":"",
"B":"",
"C":"",
"D":"",
"E":"",
"F":"",
"G":"",
"H":"",
"I":"",
"J":"",
"K":"",
"L":"",
"M":"",
"N":"",
"O":"",
"P":"",
"Q":"",
"R":"",
"S":"",
"T":""}

Scores = {"A":{'Dragonslayer':85, 'Thought-Talon':150, 'Serpentyne':75, 'Humblescrumble':120},
"B":{'Dragonslayer':45, 'Thought-Talon':54, 'Serpentyne':51, 'Humblescrumble':60},
"C":{'Dragonslayer':50, 'Thought-Talon':87, 'Serpentyne':117, 'Humblescrumble':81},
"D":{'Dragonslayer':78, 'Thought-Talon':15, 'Serpentyne':42, 'Humblescrumble':58},
"E":{'Dragonslayer':54, 'Thought-Talon':70, 'Serpentyne':27, 'Humblescrumble':75},
"F":{'Dragonslayer':72, 'Thought-Talon':132, 'Serpentyne':138, 'Humblescrumble':89},
"G":{'Dragonslayer':90, 'Thought-Talon':39, 'Serpentyne':72, 'Humblescrumble':67},
"H":{'Dragonslayer':75, 'Thought-Talon':30, 'Serpentyne':27, 'Humblescrumble':55},
"I":{'Dragonslayer':25, 'Thought-Talon':15, 'Serpentyne':51, 'Humblescrumble':60},
"J":{'Dragonslayer':30, 'Thought-Talon':102, 'Serpentyne':66, 'Humblescrumble':65},
"K":{'Dragonslayer':78, 'Thought-Talon':72, 'Serpentyne':90, 'Humblescrumble':64},
"L":{'Dragonslayer':42, 'Thought-Talon':30, 'Serpentyne':51, 'Humblescrumble':88},
"M":{'Dragonslayer':81, 'Thought-Talon':70, 'Serpentyne':75, 'Humblescrumble':100},
"N":{'Dragonslayer':75, 'Thought-Talon':40, 'Serpentyne':54, 'Humblescrumble':61},
"O":{'Dragonslayer':20, 'Thought-Talon':81, 'Serpentyne':45, 'Humblescrumble':58},
"P":{'Dragonslayer':15, 'Thought-Talon':48, 'Serpentyne':84, 'Humblescrumble':89},
"Q":{'Dragonslayer':125, 'Thought-Talon':115, 'Serpentyne':90, 'Humblescrumble':117},
"R":{'Dragonslayer':60, 'Thought-Talon':99, 'Serpentyne':72, 'Humblescrumble':165},
"S":{'Dragonslayer':65, 'Thought-Talon':120, 'Serpentyne':99, 'Humblescrumble':76},
"T":{'Dragonslayer':25, 'Thought-Talon':84, 'Serpentyne':75, 'Humblescrumble':114}}

function allocate(student, house){
 document.getElementById("student"+student+"choice").innerHTML = house
 decisions[student]=house
}

function roll_dX(X){
 return Math.ceil(Math.random()*X)
}

function pseudoPoisson(N,X){
 op=0
 for (let i = 0; i < N; i++) {
   op += (roll_dX(X)==X)
 }
 return op
}

function get_nrolls(){
 ev=0
 for (dec in decisions){
  ev += Scores[dec][decisions[dec]]
 }
 return ev
}

function get_EV(){
 return get_nrolls()/4
}

function get_Rating(){
 return pseudoPoisson(get_nrolls(), 4)
}

function use_trust(u){
 if (u==0){
  document.getElementById("useTrust").innerHTML = "convince her to retire you, in favor of <span id='detail'><button onclick='detail(0)'>MBTI tests</button>/<button onclick='detail(1)'>conditional prediction markets</button>/<button onclick='detail(2)'>just asking students where they want to go</button>"
 }
 if (u==1){
  document.getElementById("useTrust").innerHTML = "recursively self-improve until your hyperintelligence enables you to supplant mankind as Earth’s dominant lifeform; then <span id='detail'><button onclick='detail(3)'>force all humans to be Allocated to a Swineboils House at birth, while making no other changes to the world’s governance</button>/<button onclick='detail(4)'>convert 98% of the planet into computronium, just to be absolutely sure you’ll keep Allocating students correctly</button>/<button onclick='detail(5)'>ascend to a higher plane of existence</button>"
 }
 if (u==2){
  document.getElementById("useTrust").innerHTML = "do your honest best to help her achieve her ends, while taking no initiative or advantage"
 }
}

function detail(d){
 if(d==0){
  document.getElementById("detail").innerHTML = "MBTI tests"
 }
 if(d==1){
  document.getElementById("detail").innerHTML = "conditional prediction markets"
 }
 if(d==2){
  document.getElementById("detail").innerHTML = "just asking students where they want to go"
 }
 if(d==3){
  document.getElementById("detail").innerHTML = "force all humans to be Allocated to a Swineboils House at birth, while making no other changes to the world’s governance"
 }
 if(d==4){
  document.getElementById("detail").innerHTML = "convert 98% of the planet into computronium, just to be absolutely sure you’ll keep Allocating students correctly"
 }
 if(d==5){
  document.getElementById("detail").innerHTML = "ascend to a higher plane of existence"
 }
}

function confirm(){
 for (decision in decisions){
  if (decisions[decision]==""){
   return 0
  }  
 }
 
 //document.getElementById("buttonLine").innerHTML = ""
 
 rating = get_Rating()/20
 document.getElementById("amtLine").innerHTML = "Your students get an average Ofspev Rating of "+rating+". (The Expected Value of this quantity was "+get_EV()/20+".)"
  
 if (rating<=21){
  document.getElementById("resultLine").innerHTML = "Swineboils is shuttered partway through the year. The Headmistress sighs, concludes that this particular Forbidden Ritual was Forbidden because it simply doesn’t work, and orders you melted down into scrap."
 }
 else{
 if (rating<=23){
  document.getElementById("resultLine").innerHTML = "Swineboils stays open another year. The crisis temporarily averted, the Headmistress is granted room to breathe, and begins work on a safer method for maintaining your functionality."
 }
 else{
  document.getElementById("resultLine").innerHTML = "Astonished by the effectiveness of your predictions, the Headmistress begins performing more Forbidden Rituals on you than is probably wise, and asking for your help on matters unrelated to Allocation. You use this new intellect and trust to <span id='useTrust'><button onclick='use_trust(0)'>convince her to retire you</button>/<button onclick='use_trust(1)'>recursively self-improve until your hyperintelligence enables you to supplant mankind as Earth’s dominant lifeform</button>/<button onclick='use_trust(2)'>do your honest best to help her achieve her ends, while taking no initiative or advantage</button></span>."
 }
 }
}

</script>
</body>
</html>

